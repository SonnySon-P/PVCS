# VCS

專案結構應該像這樣：
your_project_folder/
  ├── main.go
  └── vcs/
      └── vcs.go

repoDir(工作區)
  ├── filesDir(暫存區)
  └── historyDir(提交區)
        ├── main
        └── branch
              ├── version_1
              └── version_2
              
go run main.go init        # 初始化版本控制
go run main.go commit "Initial commit"  # 提交更改
go run main.go status      # 查看当前文件状态
go run main.go log         # 查看提交记录
go run main.go checkout 1  # 切换到版本 1

你提到的問題確實是一個很常見的挑戰。逐行比較的方式對於文件內容的微小變化（如空白行、換行等）非常敏感，這會導致無法識別相同的內容。尤其是在檔案中插入或刪除空白行時，可能會導致程式碼不一致的錯誤。

為了解決這個問題，我們可以透過以下幾種方法來改進：

1. 忽略空白行和空白字符
我們可以忽略空行和多餘的空格，這樣即使程式碼內容在結構上有所變化，只要內容本身沒變化，依然可以視為相同。

2. 使用行內差異計算
如果我們偵測到某一行相同，但該行的內容在空格或格式上有所不同，我們可以嘗試偵測 行內差異，並且根據該差異來更新檔案內容。

3. 利用最小編輯距離演算法（Levenshtein Distance）
另一個解決方案是採用 最小編輯距離演算法（Levenshtein Distance），用於計算兩個字串的差異，並能夠提供更細微的比較。這適用於行內容相似，但具體字元不同的情況。

我將為你提供一個簡化版的解決方案，其中考慮了忽略空行以及去除每行兩端的空白字元。



在 VCS 结构中增加分支管理的功能，如创建分支、切换分支、合并分支等。
分支管理将建立在 historyDir 目录内为每个分支创建独立的文件夹，每个分支的文件夹中会包含该分支的所有版本。
分支切换通过更新 filesDir 的路径，切换到当前分支的文件夹。
分支合并则是将源分支中的文件合并到目标分支中。

repoDir（工作區）：
這是開發者直接編輯和修改文件的地方。
開發者在此進行程式碼開發、文件編輯等操作。
repoDir 存放的是目前的工作文件。
filesDir（暫存區）：
當開發者想要將檔案加入版本控制時，檔案會先被放入 filesDir。
filesDir 是暫存區（Staging Area），存放的是準備提交的文件。
使用 add 指令時，檔案會從工作區 (repoDir) 複製到 filesDir 中。
historyDir（歷史資料夾）：
存放已經提交的版本文件。每次執行 commit 指令時，filesDir 中的檔案會被複製到 historyDir 中，並形成一個版本快照。
historyDir 保留了所有提交的歷史記錄，每個版本的文件都有一個獨立的目錄，包含版本內容和提交資訊。
工作流程：
新增檔案（add）：
開發者在 repoDir 中編輯檔案後，使用 add 指令將檔案新增至 filesDir。
add 並不會提交文件，它只是把文件從工作區（repoDir）移到暫存區（filesDir）。
提交文件（commit）：
當檔案已經在 filesDir 中時，執行 commit 操作會將 filesDir 中的檔案（包括提交資訊）複製到 historyDir 中，形成一個新的版本。
每次提交都會產生一個新的版本快照，保存在 historyDir 中。
切換版本（checkout）：
切換版本時，系統會將 historyDir 中某一版本的檔案複製回 repoDir（工作區）。
repoDir 會更新為目標版本的檔案狀態。
如何切换版本或分支时的操作流程
假设您需要切换到某个版本或分支时，您的 repoDir 会更新，以便包含目标版本（或分支）的文件内容。目标是确保工作区始终与版本控制系统中的文件一致。

分支合併（merge）是版本控制中非常重要的操作，通常用于将两个分支的更改合并到一个单一的分支中。在实现简单的 VCS 系统时，分支合并主要涉及以下几个步骤：

1. 理解分支结构
在当前的分支模型中，historyDir/{branch_name} 是存放每个分支历史版本的地方，而每个分支有独立的版本控制。合併操作需要将两个分支中的更改合并在一起。

2. 分支合併的基本逻辑
在最简单的 VCS 系统中，分支合并操作可以简单地理解为：将一个分支的内容合并到另一个分支。

选择一个目标分支（targetBranch），并从另一个分支（sourceBranch）中合并更改。
通过将 sourceBranch 的版本文件和提交信息复制到 targetBranch 来合并更改。
然后可以提交一个新的合并版本，将两者的内容合并到目标分支中。
3. 实现分支合併功能
下面是一个简单的分支合併示例。我们将根据目标分支（targetBranch）和源分支（sourceBranch）的版本内容来合并文件。
